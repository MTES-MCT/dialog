{% set uuid = location.uuid %}
{% set deleteCsrfToken = csrf_token('delete-location') %}

<turbo-frame id="block_location_{{ uuid }}">
    <div class="app-card app-card--raised fr-mt-3w" data-testid="location">
        <div class="app-card__header">
            <span class="app-card__img fr-icon-map-pin-2-fill fr-x-icon-decorative--blue-france fr-x-icon--xl" aria-hidden="true"></span>
            <h3 class="app-card__title fr-h4 fr-mb-0">
                {{ location.address.roadName|default(location.address.city) }}
            </h3>
        </div>

        <div class="app-card__content">
            <ul class="fr-ml-1w fr-my-0 fr-list">
                <li>{{ location.address.city }}
				    ({{ location.address.postCode }})
                </li>
                {% if location.address.roadName %}
                <li>
                    {{ location.address.roadName }}

                        {% if location.fromHouseNumber and location.toHouseNumber %}
                            -
                            {{ 'regulation.location.house_number_from_to'|trans({ '%from%': location.fromHouseNumber, '%to%': location.toHouseNumber }) }}
                        {% elseif location.fromHouseNumber %}
                            -
                                {{ 'regulation.location.house_number_from'|trans({ '%from%': location.fromHouseNumber }) }}
                        {% elseif location.toHouseNumber %}
                            -
                            {{ 'regulation.location.house_number_to'|trans({ '%to%': location.toHouseNumber }) }}
                        {% endif %}
                </li>
                {% endif %}
                {% for measure in location.measures %}
                    <li>
                        {{ ('regulation.measure.type.' ~ measure.type)|trans }}
                        {% for period in measure.periods %}
                            {% for dayRange in period.dayRanges %}
                                {% if dayRange.firstDay == dayRange.lastDay %}
                                    {{ 'regulation.period.one_day'|trans({
                                        '%firstDay%': ('regulation.period.days.' ~ dayRange.firstDay)|trans,
                                        '%startTime%': period.startTime|date('H\\hi'),
                                        '%endTime%': period.endTime|date('H\\hi'),
                                    })|lower }}
                                {% else %}
                                    {{ 'regulation.period.many_days'|trans({
                                        '%firstDay%': ('regulation.period.days.' ~ dayRange.firstDay)|trans,
                                        '%lastDay%': ('regulation.period.days.' ~ dayRange.lastDay)|trans,
                                        '%startTime%': period.startTime|date('H\\hi'),
                                        '%endTime%': period.endTime|date('H\\hi'),
                                    })|lower }}
                                {% endif %}
                                {% if not loop.last %}- {% endif %}
                            {% endfor %}
                            {% if not loop.last %}- {% endif %}
                        {% else %}
                            {{ 'regulation.period.all_days'|trans }}
                        {% endfor %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% if regulationOrderRecord.isDraft %}
            <ul class="app-card__actions">
                <li>
                    <form method="GET" action="{{ path('fragment_regulations_location_update', { regulationOrderRecordUuid: regulationOrderRecord.uuid, uuid: location.uuid }) }}">
                        <button class="fr-btn fr-btn--tertiary fr-btn--icon-left fr-icon-edit-line fr-mt-2w fr-mt-md-0">
                            {{ 'common.update'|trans }}
                        </button>
                    </form>
                </li>
                {% if canDelete %}
                    <li id="location_{{ uuid }}_delete_button">
                        {% include 'regulation/fragments/_location_delete_form.html.twig' with { regulationOrderRecord, uuid: location.uuid, deleteCsrfToken } only %}
                    </li>
                {% else %}
                    <li id="location_{{ uuid }}_delete_button" role="presentation"></li>
                {% endif %}
            </ul>
        {% endif %}
    </div>
</turbo-frame>
