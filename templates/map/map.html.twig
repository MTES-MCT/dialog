{% extends 'layouts/public.html.twig' %}

{% block title %}
    {{'map.meta.title'|trans}} - {{ parent() }}
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('map') }}
    {{ encore_entry_link_tags('map-size') }}
{% endblock %}

{% block body %}
    <span id="locations_as_geojson" hidden>{{ locationsAsGeoJson|raw }}</span>

    <div class="fr-x-container--fluid fr-x-h-full">
        <div class="fr-grid-row fr-x-h-full">
            <div class="fr-col-12 fr-col-sm-4 fr-col-md-3 fr-container fr-pt-2w fr-pb-6w">
                <h1 class="fr-h4">{{ 'map.title'|trans }} </h1>
                <h2 class="fr-h6">{{ 'map.filters.title'|trans }}</h2>

                <d-auto-form>
                    {{ form_start(form, {
                        attr: {
                            class: 'd-stack',
                            style: '--stack-gap: var(--1w)',
                        },
                    }) }}
                        {{ form_row(form.displayPermanentRegulations, {group_class: 'fr-checkbox-group'}) }}
                        {{ form_row(form.displayTemporaryRegulations, {group_class: 'fr-checkbox-group'}) }}
                        <hr />
                        {{ form_row(form.displayFutureRegulations, {group_class: 'fr-checkbox-group'}) }}
                        {{ form_row(form.displayPastRegulations, {group_class: 'fr-checkbox-group'}) }}
                        <noscript>
                            {{ form_row(form.save) }}
                        </noscript>
                    {{ form_end(form) }}
                </d-auto-form>
            </div>

            <d-map
                class="fr-col-12 fr-col-sm-8 fr-col-md-9"
                aria-hidden="true"
                mapHeight="100%"
                mapMinHeight="600px"
                mapPos="[2.725, 47.16]"
                mapZoom="5"
                dataSource="locations_as_geojson"
                locationPopupUrl="{{ path('fragment_map_location') }}"
            >
                <p data-map-hidewhen="ready" class="fr-mt-5w fr-x-text--center">
                    {{ 'map.loading'|trans }}
                </p>
            </d-map>
        </div>
    </div>
{% endblock %}
